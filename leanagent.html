<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LeanAgent: Lifelong Learning for Formal Theorem Proving</title>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="./static/css/academicons.min.css">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
</head>
<body>

<!-- Navigation -->
<nav class="navbar is-light" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="index.html">
            <strong>LeanDojo</strong>
        </a>
    </div>
    
    <div class="navbar-menu">
        <div class="navbar-start">
            <a class="navbar-item" href="index.html">
                Home
            </a>
            <a class="navbar-item" href="leandojo.html">
                LeanDojo
            </a>
            <a class="navbar-item is-active" href="leanagent.html">
                LeanAgent
            </a>
            <a class="navbar-item" href="leancopilot.html">
                LeanCopilot
            </a>
            <a class="navbar-item" href="leanprogress.html">
                LeanProgress
            </a>
            <a class="navbar-item" href="leanide.html">
                LeanIDE
            </a>
        </div>
    </div>
</nav>

<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title">LeanAgent: Lifelong Learning for Formal Theorem Proving</h1>
                    <div class="is-size-5 publication-authors">
                        <span class="author-block">
                            <a href="#">Adarsh Kumarappan</a><sup>1</sup>,</span>
                        <span class="author-block">
                            <a href="#">Mo Tiwari</a><sup>1</sup>,</span>
                        <span class="author-block">
                            <a href="#">Peiyang Song</a><sup>1</sup>,</span>
                        <span class="author-block">
                            <a href="#">Robert Joseph George</a><sup>1</sup>,</span>
                        <span class="author-block">
                            <a href="#">Chaowei Xiao</a><sup>2</sup>,</span>
                        <span class="author-block">
                            <a href="#">Anima Anandkumar</a><sup>1</sup></span>
                    </div>

                    <div class="is-size-5 publication-authors">
                        <span class="author-block"><sup>1</sup>California Institute of Technology,</span>
                        <span class="author-block"><sup>2</sup>University of Wisconsin-Madison</span>
                    </div>

                    <div class="is-size-5 publication-authors">
                        <span class="author-block"><strong>Published:</strong> International Conference on Learning Representations (ICLR) 2025</span>
                    </div>

                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <span class="link-block">
                                <a href="#" class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                    <i class="fas fa-file-pdf"></i>
                                </span>
                                <span>Paper</span>
                                </a>
                            </span>
                            <span class="link-block">
                                <a target="_blank" href="https://github.com/lean-dojo"
                                class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                    <i class="fab fa-github"></i>
                                </span>
                                <span>Code</span>
                                </a>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="lean-infer">LeanAgent Overview</span></h2>
                    <img src="images/leanagent_overview.png" class="interpolation-image" alt="LeanAgent Overview" style="display: block; margin-left: auto; margin-right: auto; width: 90%;"/>
                    <br />
                    <p style="font-size: 125%"><strong>LeanAgent overview.</strong> LeanAgent searches for Lean repositories and uses LeanDojo to extract theorems and proofs. It uses curriculum learning, computing theorem complexity as e^S (S = proof steps) and calculating the 33rd and 67th complexity percentiles across all theorems to sort repositories by easy theorem count. LeanAgent adds the curriculum to its dynamic database. As a retrieval-based framework, LeanAgent generates a dataset (premise corpus and a collection of theorems and proofs) for each repository in the curriculum and progressively trains its retriever. Progressive training happens over one epoch to prevent forgetting old knowledge. Then, LeanAgent uses the updated retriever in a search-based method to generate formal proofs for theorems where formal proofs were previously missing, known as sorry theorems. It adds new proofs to the database.</p>
                    <br />
                    <h2 class="title is-3"><span class="lean-infer">Key Results</span></h2>
                    <p style="font-size: 125%"><strong>LeanAgent successfully generates formal proofs for 155 theorems across 23 diverse Lean repositories</strong> where formal proofs were previously missing, many from advanced mathematics including abstract algebra, algebraic topology, and complex analysis. It significantly outperforms static baselines like ReProver, demonstrating clear progression from basic concepts to advanced topics. Key repositories include the Polynomial Freiman-Ruzsa Conjecture, Hairy Ball Theorem, Coxeter groups, and scientific computing frameworks.</p>
                    <br />
                    <h2 class="title is-3"><span class="lean-infer">Abstract</span></h2>
                    <p style="font-size: 125%">Large Language Models (LLMs) have been successful in mathematical reasoning tasks such as formal theorem proving when integrated with interactive proof assistants like Lean. Existing approaches involve training or fine-tuning an LLM on a specific dataset to perform well on particular domains, such as undergraduate-level mathematics. These methods struggle with generalizability to advanced mathematics. A fundamental limitation is that these approaches operate on static domains, failing to capture how mathematicians often work across multiple domains and projects simultaneously or cyclically. We present LeanAgent, a novel lifelong learning framework for formal theorem proving that continuously generalizes to and improves on ever-expanding mathematical knowledge without forgetting previously learned knowledge. LeanAgent introduces several key innovations, including a curriculum learning strategy that optimizes the learning trajectory in terms of mathematical difficulty, a dynamic database for efficient management of evolving mathematical knowledge, and progressive training to balance stability and plasticity. LeanAgent successfully generates formal proofs for 155 theorems across 23 diverse Lean repositories where formal proofs were previously missing, many from advanced mathematics. It performs significantly better than the static LLM baseline, proving challenging theorems in domains like abstract algebra and algebraic topology while showcasing a clear progression of learning from basic concepts to advanced topics. In addition, we analyze LeanAgent's superior performance on key lifelong learning metrics. LeanAgent achieves exceptional scores in stability and backward transfer, where learning new tasks improves performance on previously learned tasks. This emphasizes LeanAgent's continuous generalizability and improvement, explaining its superior theorem-proving performance.</p>
                    <br />
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="dvima">Key Innovations</span></h2>
                    <div class="content">
                        <h3 class="title is-4">Curriculum Learning Strategy</h3>
                        <p style="font-size: 125%">LeanAgent employs a sophisticated curriculum learning approach that uses theorem complexity based on e^S (where S is the number of proof steps) to order repositories by difficulty. It calculates the 33rd and 67th complexity percentiles to categorize theorems as easy, medium, or hard, then sorts repositories by their count of easy theorems to create an optimal learning trajectory.</p>
                        
                        <h3 class="title is-4">Dynamic Knowledge Database</h3>
                        <p style="font-size: 125%">The system maintains a comprehensive dynamic database that tracks repository metadata, theorem categorization (proven, sorry proven, sorry unproven), premise files with imports, traced files, and detailed theorem information including proof states. This enables efficient reuse and management of evolving mathematical knowledge across repositories.</p>
                        
                        <h3 class="title is-4">Progressive Training Architecture</h3>
                        <p style="font-size: 125%">LeanAgent implements progressive training that incrementally trains the retriever on newly generated datasets for exactly one epoch per repository to prevent catastrophic forgetting. This approach balances stability (retaining old knowledge) with plasticity (learning new concepts), achieving superior performance on lifelong learning metrics including backward transfer.</p>
                        
                        <h3 class="title is-4">Best-First Tree Search with Retrieval</h3>
                        <p style="font-size: 125%">For sorry theorem proving, LeanAgent uses a best-first tree search that generates tactic candidates at each step, retrieves relevant premises based on similarity to the current proof state, and applies dependency filtering to ensure only accessible premises are considered. The search continues until a proof is found or the 10-minute time limit is reached.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="lean-infer">Technical Architecture & Results</span></h2>
                    <div class="content">
                        <h3 class="title is-4">Experimental Setup</h3>
                        <p style="font-size: 125%">LeanAgent was evaluated on 23 diverse Lean repositories including advanced mathematical domains such as the Polynomial Freiman-Ruzsa Conjecture, Hairy Ball Theorem (algebraic topology), Coxeter groups, Mathematics in Lean textbook, scientific computing (SciLean), Carleson's Theorem, and various olympiad-style problems (MiniF2F). The system uses ReProver's retriever as the starting point and progressively trains on each repository for one epoch.</p>
                        
                        <h3 class="title is-4">Performance Results</h3>
                        <p style="font-size: 125%">LeanAgent successfully proved 155 sorry theorems across the 23 repositories, significantly outperforming the static ReProver baseline. Notable achievements include proving theorems in advanced abstract algebra (Wedderburn's Little Theorem), algebraic topology (Hairy Ball Theorem components), complex analysis, and successfully handling the challenging PFR repository where it was the only system to prove theorems. The system demonstrated clear progression from basic arithmetic to advanced mathematical concepts.</p>
                        
                        <h3 class="title is-4">Lifelong Learning Analysis</h3>
                        <p style="font-size: 125%">LeanAgent achieved exceptional performance on six lifelong learning metrics: superior Windowed-Forgetting (75.34% lower than alternatives), excellent Catastrophic Forgetting Resilience (0.88), and positive Expanded Backward Transfer (1.21), indicating that learning new tasks actually improved performance on previously learned tasks. This demonstrates LeanAgent's continuous generalizability and improvement capabilities.</p>
                        
                        <h3 class="title is-4">Repository-Specific Insights</h3>
                        <p style="font-size: 125%">Mathematics in Lean Source: 72.4% accuracy (21/29 theorems), progressing from basic algebraic structures to advanced quantifier manipulation and set theory. SciLean: 9.2% accuracy (27/294 theorems), advancing from fundamental operations to sophisticated function spaces and abstract algebraic structures. MiniF2F: 24.4% accuracy (99/406 theorems), improving from basic arithmetic to complex induction and advanced number theory. PFR: Only system to prove theorems (2.7% accuracy), demonstrating unique capability in advanced mathematical research.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="lean-infer">Impact & Future Directions</span></h2>
                    <div class="content">
                        <h3 class="title is-4">Contributions to Formal Mathematics</h3>
                        <p style="font-size: 125%">LeanAgent represents a significant step toward practical AI assistance in formal mathematics. By successfully proving previously unproven theorems across diverse repositories, it demonstrates the potential for AI systems to contribute meaningfully to mathematical research. The system discovered 7 exploits within Lean's type system and has contributed proofs back to the mathematical community through pull requests to repository maintainers.</p>
                        
                        <h3 class="title is-4">Broader Applications</h3>
                        <p style="font-size: 125%">The lifelong learning framework extends beyond theorem proving to any domain requiring continuous knowledge accumulation without catastrophic forgetting. Potential applications include software verification, automated reasoning in legal systems, and scientific hypothesis generation. The approach of combining curriculum learning with progressive training offers a template for building robust AI systems that can adapt to evolving knowledge domains.</p>
                        
                        <h3 class="title is-4">Future Research Directions</h3>
                        <p style="font-size: 125%">Future work could explore integration with interactive proof assistants like Lean Copilot for real-time assistance, incorporation of reinforcement learning for synthetic data generation during curriculum construction, and extension to additional mathematical libraries and theorem provers. The framework's modular design allows for integration with various large language models and search strategies, opening possibilities for more sophisticated reasoning architectures.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<footer class="footer">
    <div class="container">
        <div class="columns is-centered">
            <div class="column">
                <div class="content has-text-centered">
                    <p>
                        Website template borrowed from <a
                            href="https://vimalabs.github.io/">VIMA</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

</body>
</html>