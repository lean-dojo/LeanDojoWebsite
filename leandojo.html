<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LeanDojo: AI-Assisted Theorem Proving in Lean</title>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="./static/css/academicons.min.css">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
</head>
<body>

<!-- Navigation -->
<nav class="navbar is-light" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="index.html">
            <strong>LeanDojo</strong>
        </a>
    </div>
    
    <div class="navbar-menu">
        <div class="navbar-start">
            <a class="navbar-item" href="index.html">
                Home
            </a>
            <a class="navbar-item is-active" href="leandojo.html">
                LeanDojo
            </a>
            <a class="navbar-item" href="leanagent.html">
                LeanAgent
            </a>
            <a class="navbar-item" href="leancopilot.html">
                LeanCopilot
            </a>
            <a class="navbar-item" href="leanprogress.html">
                LeanProgress
            </a>
            <a class="navbar-item" href="leanide.html">
                LeanIDE
            </a>
        </div>
    </div>
</nav>

<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title">LeanDojo-v2: A Comprehensive Library for AI-Assisted Theorem Proving in Lean</h1>
                    <h2 class="subtitle is-4">End-to-End Framework for Training, Evaluating, and Deploying AI-Assisted Theorem Provers for Lean 4</h2>
                    
                    <div class="is-size-5 publication-authors">
                        <span class="author-block">
                            <a target="_blank" href="#">Ryan Hsiang</a><sup>1</sup>,
                            <a target="_blank" href="#">Will Adkisson</a><sup>2</sup>,
                            <a target="_blank" href="https://www.robertj1.com/">Robert Joseph George</a><sup>1</sup>,
                            <a target="_blank" href="http://tensorlab.cms.caltech.edu/users/anima/">Anima Anandkumar</a><sup>1</sup>
                        </span>
                    </div>

                    <div class="is-size-5 publication-authors">
                        <span class="author-block"><sup>1</sup>California Institute of Technology; </span>
                        <span class="author-block"><sup>2</sup>Washington University</span>
                    </div>

                    <div class="is-size-5 publication-authors">
                        <span class="author-block"><strong>Published:</strong> NeurIPS Mathematical Reasoning and AI, 2025</span>
                    </div>

                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <span class="link-block">
                            <a target="_blank" href="https://github.com/lean-dojo/LeanDojo-v2"
                            class="external-link button is-normal is-rounded is-dark">
                            <span class="icon">
                                <i class="fab fa-github"></i>
                            </span>
                            <span>Code</span>
                            </a>
                            </span>

                            <span class="link-block">
                                <a target="_blank" href="https://neurips.cc/virtual/2025/workshop/109565"
                                class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                    <i class="fas fa-file-pdf"></i>
                                </span>
                                <span>Paper</span>
                            </a>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="lean-infer">LeanDojo-v2: The Updated Library</span></h2>
                    <p style="font-size: 125%">LeanDojo-v2 is an end-to-end framework for training, evaluating, and deploying AI-assisted theorem provers for Lean 4. It combines repository tracing, lifelong dataset management, retrieval-augmented agents, Hugging Face fine-tuning, and external inference APIs into one toolkit.</p>
                    <br />
                    <h3 class="title is-4">Key Features</h3>
                    <div class="columns">
                        <div class="column">
                            <h4 class="title is-5">Repository Tracing</h4>
                            <p style="font-size: 125%">Automatically clones Lean repositories (GitHub or local) and traces them with Lean instrumentation to extract theorem information, proof states, and structured data for training.</p>
                        </div>
                        <div class="column">
                            <h4 class="title is-5">Lifelong Dataset Management</h4>
                            <p style="font-size: 125%">Stores structured theorem information in a dynamic database that keeps repositories sorted by difficulty and appends new theorems without retracing everything.</p>
                        </div>
                    </div>
                    <br />
                    <div class="columns">
                        <div class="column">
                            <h4 class="title is-5">Multiple Agent Types</h4>
                            <p style="font-size: 125%"><strong>HFAgent:</strong> Uses Hugging Face models fine-tuned locally with SFTTrainer or GRPOTrainer. <strong>ExternalAgent:</strong> Uses Hugging Face Inference API for large models without local GPU resources. <strong>LeanAgent:</strong> Implements lifelong learning with retrieval-augmented generation.</p>
                        </div>
                        <div class="column">
                            <h4 class="title is-5">Flexible Training Options</h4>
                            <p style="font-size: 125%"><strong>SFTTrainer:</strong> Supervised fine-tuning with LoRA support. <strong>GRPOTrainer:</strong> Group Relative Policy Optimization for reinforcement learning. <strong>RetrievalTrainer:</strong> Trains dense retrievers for premise selection.</p>
                        </div>
                    </div>
                    <br />
                    <div class="columns">
                        <div class="column">
                            <h4 class="title is-5">Proof Methods</h4>
                            <p style="font-size: 125%">Supports both <strong>whole-proof generation</strong> (complete proof in one forward pass) and <strong>proof search</strong> (sequential tactic generation with state interaction through Pantograph).</p>
                        </div>
                        <div class="column">
                            <h4 class="title is-5">LeanProgress Integration</h4>
                            <p style="font-size: 125%">Includes support for step-prediction models that estimate remaining proof steps, improving search efficiency through intelligent guidance.</p>
                        </div>
                    </div>
                    <br />
                    <p style="font-size: 125%">The codebase is modular and extensible—you can implement custom agents by pairing trainers with compatible provers. For detailed documentation and usage examples, visit the <a target="_blank" href="https://github.com/lean-dojo/LeanDojo-v2">GitHub repository</a>.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="lean-infer">Original LeanDojo (Deprecated)</span></h2>
                    <p style="font-size: 125%; color: #666;"><em>Note: The original LeanDojo library is deprecated. Please use <a target="_blank" href="https://github.com/lean-dojo/LeanDojo-v2">LeanDojo-v2</a> for all new projects. The information below is kept for historical reference.</em></p>
                    <br />
                    <h3 class="title is-4">Overview of Original LeanDojo</h3>
                    <img src="images/LeanDojo.jpg" class="interpolation-image" alt="" style="display: block; margin-left: auto; margin-right: auto"/>
                    <br /> 
                    <p style="font-size: 125%"><b>Top right</b>: LeanDojo extracts proofs in <a target="_blank" href="https://leanprover.github.io/">Lean</a> into datasets for training machine learning models. It also enables the trained model to prove theorems by interacting with Lean's proof environment.</p>
                    <br />  
                    <p style="font-size: 125%"><b>Top left</b>: The proof tree of a Lean theorem <a target="_blank" href="https://github.com/leanprover-community/lean/blob/cce7990ea86a78bdb383e38ed7f9b5ba93c60ce0/library/init/data/nat/gcd.lean#L36">\(\forall n \in \mathbb{N},~\texttt{gcd n n = n}\)</a>, where <span style="background-color:rgb(222, 235, 247);">\(\texttt{gcd}\)</span> is the greatest common divisor. When proving the theorem, we start from the original theorem as the initial state (the root) and repeatedly apply tactics (the edges) to decompose states into simpler sub-states, until all states are solved (the leaf nodes). Tactics may rely on premises such as <span style="background-color:rgb(251, 229, 214);">\(\texttt{mod_self}\)</span> and  <span style="background-color:rgb(226, 240, 217);">\(\texttt{gcd_zero_left}\)</span> defined in a large math library. E.g., <span style="background-color:rgb(251, 229, 214);">\(\texttt{mod_self}\)</span> is an existing theorem <a target="_blank" href="https://github.com/leanprover-community/lean/blob/cce7990ea86a78bdb383e38ed7f9b5ba93c60ce0/library/init/data/nat/lemmas.lean#L861">\(\forall n \in \mathbb{N},~\texttt{n % n = 0}\)</a> used in the proof to simplify the goal.</p>
                    <br />
                    <p style="font-size: 125%"><b>Bottom</b>: Our ReProver model. Given a state, it retrieves premises from the math library, which are concatenated with the state and fed into an encoder-decoder Transformer to generate the next tactic.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="lean-infer">Core Innovation</span></h2>
                    <p style="font-size: 125%">LeanDojo serves as the foundational infrastructure that bridges the gap between the Python-based world of machine learning and the specialized environment of the Lean prover. It solves the critical data extraction and interaction problems that enable all subsequent research in AI-driven theorem proving.</p>
                    <br />
                    <h3 class="title is-4">Key Capabilities</h3>
                    <div class="columns">
                        <div class="column">
                            <h4 class="title is-5">Data Extraction</h4>
                            <p style="font-size: 125%">Systematically extracts rich datasets from Lean repositories, including abstract syntax trees (ASTs), file dependencies, proof states, tactics, and fine-grained premise annotations—essential for training retrieval-augmented models.</p>
                        </div>
                        <div class="column">
                            <h4 class="title is-5">Interactive Environment</h4>
                            <p style="font-size: 125%">Transforms Lean into a gym-like environment where AI agents can programmatically observe proof states, submit tactics, and receive feedback—indispensable for evaluation, deployment, and reinforcement learning.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered ">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="dvima">Benchmarks</span></h2>
                    <p style="font-size: 125%">
                        <ul style="font-size: 125%; padding-left: 5%">
                            <li><a href="https://doi.org/10.5281/zenodo.8016385"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.8016385.svg" alt="DOI"></a> <b>LeanDojo Benchmark</b>: 98,734 theorems/proofs, 217,776 tactics, and 130,262 premises from <a target="_blank" href="https://github.com/leanprover-community/mathlib/tree/19c869efa56bbb8b500f2724c0b77261edbfa28c">mathlib</a>.</li>
                            <li><a href="https://doi.org/10.5281/zenodo.8040109"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.8040109.svg" alt="DOI"></a> <b>LeanDojo Benchmark 4</b>: 122,517 theorems/proofs, 259,580 tactics, and 167,779 premises from <a target="_blank" href="https://github.com/leanprover-community/mathlib4/tree/29dcec074de168ac2bf835a77ef68bbe069194c5">mathlib4</a>.</li>
                        </ul>
                    </p>
                    <br />
                    <p style="font-size: 125%">LeanDojo can extract data from any GitHub repos in Lean (supporting both Lean 3 and Lean 4). The data contains rich information not directly visible in the raw Lean code, including file dependencies, abstract syntax trees (ASTs), proof states, tactics, and premises.</p>
                    <br />
                    <p style="font-size: 125%"><b>Key feature 1: Premise information</b>: LeanDojo Benchmark contains fine-grained annotations of premises (where they are used in proofs and where they are defined in the library), providing valuable data for premise selection&mdash;a key bottleneck in theorem proving.</p>
                    <br />
                    <p style="font-size: 125%"><b>Key feature 2: Challenging data split</b>: Splitting theorems randomly into training/testing leads to overestimated performance. LLMs can prove seemingly difficult theorems simply by memorizing the proofs of similar theorems during training. We mitigate this issue by designing challenging data split requiring the model to generalize to theorems relying on novel premises that are never used in training.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered ">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="dvima">Interacting with Lean</span></h2>
                    <img src="images/interaction.jpg" width="50%" class="interpolation-image" alt="" style="display: block; margin-left: auto; margin-right: auto"/>
                    <p style="font-size: 125%">LeanDojo turns Lean into a <a target="_blank" href="https://github.com/openai/gym">gym-like</a> environment, in which the prover can observe the proof state, run tactics to change the state, and receive feedback on errors or on proof completion. This environment is indispensable for evaluating/deploying the prover or training it through RL.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered ">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="dvima">Experiments</span></h2>
                    <img src="images/results.png" width="40%" class="interpolation-image" alt="" style="display: block; margin-left: auto; margin-right: auto"/>
                    <br />
                    <p style="font-size: 125%">We use LeanDojo Benchmark to train and evaluate ReProver. During testing, the tactic generator is combined with best-first search to search for complete proofs. The table shows the percentage of theorem proved within 10 minutes. The \(\texttt{novel_premises}\) spilt is much more challenging than the \(\texttt{random}\) split. On both data splits, ReProver outperforms Lean's built-in proof automation tactic (tidy), a baseline that generates tactics directly without retrieval, and another baseline using GPT-4 to generate tactics in a zero-shot manner.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered ">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="dvima">Discovering New Proofs and Uncovering Formalization Bugs</span></h2>
                    <p style="font-size: 125%">We evaluate ReProver on theorems in miniF2F and ProofNet. It discovers <a target="_blank" href="https://github.com/facebookresearch/miniF2F/pull/13">33 proofs in miniF2F</a> and <a target="_blank" href="https://github.com/zhangir-azerbayev/ProofNet/pull/14">39 proofs in ProofNet</a> of theorems that did not have existing proofs in Lean. Our proofs have helped ProofNet uncover multiple bugs in the formalization of theorem statements.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-centered ">
                <div class="row is-full-width">
                    <h2 class="title is-3"><span class="dvima" id="chatgpt-for-theorem-proving">ChatGPT for Theorem Proving</span></h2>
                    <div class="columns">
                        <div class="column has-text-left video-column">
                            <video controls muted width="100%">
                                <source src="images/chatgpt-1.mp4" type="video/mp4">
                            </video>
                            <div align="center">
                                <a target="_blank" href="https://github.com/yangky11/lean-example/blob/5a0360e49946815cb53132638ccdd46fb1859e2a/src/example.lean#L3">\(a + b + c = a + c + b\)</a>
                            </div>
                        </div>

                        <div class="column has-text-left video-column">
                            <video controls muted width="100%">
                                <source src="images/chatgpt-2.mp4" type="video/mp4">
                            </video>
                            <div align="center">
                                <a target="_blank" href="https://github.com/leanprover-community/mathlib/blob/19c869efa56bbb8b500f2724c0b77261edbfa28c/src/analysis/special_functions/stirling.lean#L252">Stirling's formula</a>
                            </div>
                        </div>

                        <div class="column has-text-left video-column">
                            <video controls muted width="100%">
                                <source src="images/chatgpt-3.mp4" type="video/mp4">
                            </video>
                            <div align="center">
                                <a target="_blank" href="https://github.com/leanprover-community/mathlib/blob/19c869efa56bbb8b500f2724c0b77261edbfa28c/src/algebra/big_operators/intervals.lean#L195">Gauss' summation formula</a>
                            </div>
                        </div>
                    </div>
                    <br />
                    <p style="font-size: 125%">We build a <a target="_blank" href="https://github.com/lean-dojo/LeanDojoChatGPT">LeanDojo ChatGPT plugin</a> that enables ChatGPT to prove theorems by interacting with Lean. Compared to specialized LLMs finetuned for theorem proving (e.g., ReProver), ChatGPT can interleave informal mathematics with formal proof steps, similar to how humans interact with proof assistants. It can explain error messages from Lean and is more steerable (by prompt engineering) than specialized provers. However, it struggles to find correct proofs in most cases, due to weakness in search and planning.</p>
                </div>
            </div>
        </div>
    </div>
</section>


<footer class="footer">
    <div class="container">
        <div class="columns is-centered">
            <div class="column">
                <div class="content has-text-centered">
                    <p>
                        Website template borrowed from <a
                            href="https://vimalabs.github.io/">VIMA</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

</body>
</html>